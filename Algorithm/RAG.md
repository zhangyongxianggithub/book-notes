# 什么事检索增强生成
检索增强生成(RAG, Retrieval Augmented Generation)是指对大型语言模型输出进行优化，使其能够在生成响应之前引用训练数据来源之外的权威知识库。大型语言模型(LLM)用海量数据进行训练，使用数十亿个参数为回答问题、翻译语言和完成句子等任务生成原始输出。在LLM本就强大的功能基础上，RAG将其扩展为能访问特定领域或组织内的内部知识库，所有这些都无须重新训练模型。这是一个经济高效地改进LLM输出的方法，让它在各种情境下都能保持相关性、准确性和实用性。
# 为什么检索增强生成很重要?
LLM是一项关键的人工智能技术，为智能聊天机器人和其他自然语言处理(NLP)应用程序提供支持。目标是通过交叉引用权威知识来源，创建能够在各种环境中回答用户问题的机器人。不幸的是，LLM技术的本质在LLM响应中引入了不可预测性。此外，LLM训练数据是静态的，并引入了其所掌握知识的截止日期。LLM面临的已知挑战包括:
- 在没有答案的情况下提供虚假信息
- 当用户需要特定的当前响应时，提供过时或者通用的信息
- 从非权威来源创建响应
- 由于术语混淆，不同的培训来源使用相同的术语来谈论不同的事情，因此会产生不准确的响应

大语言模型是一个过于热情的新员工，拒绝了解实事，但形式会绝对自信的回答每一个问题。不幸的是，这种态度会对用户的信任产生负面影响。RAG是解决其中一些挑战的一种方法。它会重定向LLM，从权威的、预先确定的知识来源中检索相关信息。组织可以更好地控制生成的文本输出，并且用户可以深入了解LLM如何生成响应。
# 检索增强生成有哪些好处
RAG技术为组织的生成式人工智能工作带来了多项好处
- 经济高效的实施: 聊天机器人开发通常从基础模型开始。基础模型(FM)是在广泛的广义和未标记数据上训练的API可访问LLM。针对组织或领域特定信息重新训练FM的计算和财务的成本很高。RAG是一种将新数据引入LLM的更加经济高效的方法。它使生成式人工智能技术更广泛地获得和使用
- 当前信息: 即时LLM的原始训练数据来源适合您的需求，但保持相关性也具有挑战性。RAG允许开发人员为生成模型提供最新的研究、统计数据或新闻。它们可以使用RAG将LLM直接连接到实时社交媒体提要、新闻网站或其他经常更新的信息来源，然后，LLM可以向用户提供最新信息
- 增强用户信任度: RAG允许LLM通过来源归属来呈现准确的信息。输出可以包括对来源的引文或引用。如果需要进一步说明或更详细的信息，用户也可以自己查找源文档，这可以增加对你的生成式人工智能解决方案的信任与信息
- 更多的开发人员控制权: 借助RAG，开发人员可以更高效的测试和该井它们的聊天应用程序。他们可以控制和更改LLM的信息来源以适应不断变化的需求或跨职能使用。开发人员还可以将敏感信息的检索限制在不同的授权级别内，并确保LLM生成适当的响应。此外，如果LLM针对特定问题引用了错误的信息来源，他们还可以进行故障拍粗并进行修复。
# 检索增强生成的工作原理是什么?
如果没有RAG，LLM会接受用户输入，并根据它所接受训练的信息或它已经知道的信息创建响应。RAG引入了一个信息检索组件，该组件利用用户输入首先从新数据源提取信息。用户查询和相关信息都提供给LLM，LLM使用新知识及其训练数据来创建更好的响应。
- 创建外部数据: LLM原始训练数据集之外的新数据称为外部数据。它可以来自多个数据来源，例如API、数据库或者文档数据库。数据可能以各种格式存在，比如文件、数据库记录或长篇文本。另一种称为嵌入语言模型的AI技术将数据转换为数字表示形式并将其存储在向量数据库中。这个过程会创建一个生成式人工智能模型可以理解的知识库
- 检索相关信息: 下一步是执行相关性搜索。用户查询将转换为向量表示形式，并与向量数据库匹配。比如: 考虑一个可以回答组织的人力资源问题的智能聊天机器人。如果员工搜索: 我有多少年假?系统将检索年假政策文件以及员工个人过去的休假记录。这些特定文件将被退回，因为它们与员工输入的内容高度相关。相关性是使用数学向量计算和表示法计算和建立的
- 增强LLM提示: 接下来，RAG模型通过在上下文中添加检索到的相关数据来增强用户输入或者提示。此步骤使用提示工程技术与LLM进行有效沟通。增强提示允许大型语言模型为用户查询生成准确的答案
- 更新外部数据: 如果外部数据过时了怎么办?要维护当前信息以供检索，请异步更新文档并更新文档的嵌入表示形式。可以通过自动化实时流程或定期批处理来执行此操作。这是数据分析中常见的挑战可以使用不同的数据科学方法进行变更管理。

[RAG与LLM配合使用的概念流程](./rag/jumpstart-fm-rag.jpg)
# 检索增强生成和语义搜索有什么区别
语义搜索可以提高RAG结果。适用于想要在其LLM应用程序中添加大量外部知识源的组织。现代企业在各种系统中存储大量信息，例如手册、常见问题、研究报告、客户服务指南和人力资源文档存储库等。上下文检索在规模上具有挑战性，因此会降低生成输出质量。语义搜索技术可以扫描包含不同信息的大型数据库，并更准确的检索数据。例如: 他们可以回答诸如去年在机械维修上花了多少钱?之类的问题，方法是将问题映射到相关文档并返回特定文本而不是搜索结果。然后，开发人员可以使用该答案为LLM提供更多上下文。RAG中的传统或关键字搜索解决方案对知识密集型任务产生的结果有限。开发人员在手动准备数据时还必须处理单词嵌入、文档分块和其他复杂问题。相比之下，语义搜索技术可以完成知识库准备的所有工作，它们还生成语义相关的段落和按相关性排序的标记词，以最大限度地提高RAG有效载荷的质量。