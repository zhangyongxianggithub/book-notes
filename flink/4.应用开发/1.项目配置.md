Flink程序以来的库:
- Flink API库
- Flink连接器库
- 用户逻辑的第三方库
使用maven创建一个Flink应用程序

```bash
mvn archetype:generate               
  -DarchetypeGroupId=org.apache.flink   \
  -DarchetypeArtifactId=flink-quickstart-java \
  -DarchetypeVersion=1.17-SNAPSHOT
```

如果你想通过简单地执行主类来运行你的作业，需要classpath里有flink-runtime。对于Table API程序，还需要flink-table-runtime和 flink-table-planner-loader。Flink建议将应用程序代码与所有必须的依赖打包进一个fat/uber JAR中，包括打包连接器与第三方依赖，此规则不适用于 Java API、DataStream Scala API 以及前面提到的运行时模块，它们已经由 Flink 本身提供，不应包含在作业的 uber JAR 中。你可以把该作业 JAR 提交到已经运行的 Flink 集群，也可以轻松将其添加到 Flink 应用程序容器镜像中，而无需修改发行版。
# 如何使用Maven配置项目
Java的默认JVM堆大小对于Flink来说可能太小，您应该手动增加它。在Eclipse中，选中Run Configurations -> Arguments并在VM Arguments框里填上：-Xmx800m。在IntelliJ IDEA中，推荐选中Help | Edit Custom VM Options菜单修改JVM属性。要使应用程序在IntelliJ IDEA中运行，需要在运行配置中的Include dependencies with Provided scope打勾。如果此选项不可用（可能是由于使用了较旧的IntelliJ IDEA版本），可创建一个调用应用程序main()方法的测试用例。
# 构建项目
如果您想构建/打包您的项目，请转到您的项目目录并运行`mvn clean package`命令。您将找到一个JAR文件，其中包含您的应用程序（还有已作为依赖项添加到应用程序的连接器和库）: target/<artifact-id>-<version>.jar。
注意: 如果您使用不同于DataStreamJob的类作为应用程序的主类/入口点，我们建议您对pom.xml文件里的mainClassName配置进行相应的修改。这样，Flink 可以通过JAR文件运行应用程序，而无需额外指定主类.
# 向项目添加依赖项
比如按照下面的方式添加依赖项
```xml
<dependencies>
    <dependency>
        <groupId>org.apache.flink</groupId>
        <artifactId>flink-connector-kafka</artifactId>
        <version>1.17-SNAPSHOT</version>
    </dependency>
</dependencies>
```
当您在由Java Project Template、Scala Project Template或Gradle创建出来的项目里，运行mvn clean package会自动将应用程序依赖打包进应用程序JAR。对于不是通过这些模板创建的项目，我们建议使用Maven Shade插件以将所有必需的依赖项打包进应用程序JAR。重要提示: 请注意，应将所有核心依赖项的生效范围置为provided。这意味着只需要对它们进行编译，但不应将它们打包进项目生成的应用程序JAR文件中。如果不设置为provided，最好的情况是生成的JAR变得过大，因为它还包含所有Flink核心依赖项。最坏的情况是添加到应用程序JAR文件中的Flink核心依赖项与您自己的一些依赖项的版本冲突（通常通过反向类加载来避免）。要将依赖项正确地打包进应用程序JAR中，必须把应用程序依赖项的生效范围设置为compile。
# 打包应用程序
在部署应用到Flink环境之前，您需要根据使用场景用不同的方式打包Flink应用程序。如果您想为Flink作业创建JAR并且只使用Flink依赖而不使用任何第三方依赖，就不需要创建一个uber/fatJAR或将任何依赖打进包。如果您想为Flink作业创建JAR并使用未内置在Flink发行版中的外部依赖项，您可以将它们添加到发行版的类路径中，或者将它们打包进您的uber/fat应用程序JAR中。您可以将生成的uber/fat JAR提交到本地或远程集群：
```bash
bin/flink run -c org.example.MyJob myFatJar.jar
```
# 创建包含依赖项的 uber/fat JAR 的模板
为构建一个包含所有必需的Connector第三方类库依赖的应用程序JAR，可以使用如下shade插件定义：
```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>3.1.1</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                    <configuration>
                        <artifactSet>
                            <excludes>
                                <exclude>com.google.code.findbugs:jsr305</exclude>
                            </excludes>
                        </artifactSet>
                        <filters>
                            <filter>
                                <!-- Do not copy the signatures in the META-INF folder.
                                Otherwise, this might cause SecurityExceptions when using the JAR. -->
                                <artifact>*:*</artifact>
                                <excludes>
                                    <exclude>META-INF/*.SF</exclude>
                                    <exclude>META-INF/*.DSA</exclude>
                                    <exclude>META-INF/*.RSA</exclude>
                                </excludes>
                            </filter>
                        </filters>
                        <transformers>
                            <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                                <!-- Replace this with the main class of your job -->
                                <mainClass>my.programs.main.clazz</mainClass>
                            </transformer>
                            <transformer implementation="org.apache.maven.plugins.shade.resource.ServicesResourceTransformer"/>
                        </transformers>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```
Maven shade插件默认会包含生效范围是runtime或compile的依赖项。